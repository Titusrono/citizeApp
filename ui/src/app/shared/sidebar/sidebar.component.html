<!-- Mobile sidebar overlay -->
<div 
  *ngIf="isMobile && sidebarOpen" 
  class="fixed inset-0 bg-black bg-opacity-50 z-40 md:hidden" 
  (click)="closeSidebar()">
</div>

<!-- Sidebar -->
<aside 
  class="bg-white shadow-lg flex flex-col h-full z-50 transition-transform duration-300 ease-in-out"
  [ngClass]="{
    'fixed inset-y-0 left-0 w-64 transform': isMobile,
    'translate-x-0': isMobile && sidebarOpen,
    '-translate-x-full': isMobile && !sidebarOpen,
    'relative w-64': !isMobile
  }">
  
  <!-- Navigation Menu (Scrollable) -->
  <nav class="flex-1 p-4 space-y-2 overflow-y-auto">
    <!-- Citizen Section -->
    <div *ngIf="hasCitizenAccess()">
      <div class="px-3 py-2 text-xs font-semibold text-gray-500 uppercase tracking-wider">
        Citizen Portal
      </div>
      <a 
        *ngFor="let item of getCitizenItems()"
        [routerLink]="item.path"
        (click)="closeSidebar()"
        class="flex items-center px-4 py-3 text-gray-700 rounded-lg transition-all duration-200 hover:bg-gray-100 group"
        [class.bg-blue-50]="isActiveRoute(item.path)"
        [class.border-r-4]="isActiveRoute(item.path)"
        [class.border-blue-500]="isActiveRoute(item.path)"
        [class.text-blue-700]="isActiveRoute(item.path)"
        [class.font-semibold]="isActiveRoute(item.path)">
        
        <svg 
          class="w-5 h-5 mr-3 transition-colors duration-200 flex-shrink-0"
          [ngClass]="isActiveRoute(item.path) ? 'text-blue-600' : item.color"
          fill="none" 
          stroke="currentColor" 
          viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" [attr.d]="item.icon"></path>
        </svg>
        
        <span class="text-sm font-medium">{{ item.label }}</span>
        
        <!-- Active indicator -->
        <div 
          *ngIf="isActiveRoute(item.path)" 
          class="ml-auto w-2 h-2 bg-blue-500 rounded-full flex-shrink-0">
        </div>
      </a>
    </div>

    <!-- Admin Section -->
    <div *ngIf="hasAdminAccess()" [class.mt-4]="hasCitizenAccess()">
      <div class="px-3 py-2 text-xs font-semibold text-gray-500 uppercase tracking-wider">
        Administration
      </div>
      <a 
        *ngFor="let item of getAdminItems()"
        [routerLink]="item.path"
        (click)="closeSidebar()"
        class="flex items-center px-4 py-3 text-gray-700 rounded-lg transition-all duration-200 hover:bg-gray-100 group"
        [class.bg-blue-50]="isActiveRoute(item.path)"
        [class.border-r-4]="isActiveRoute(item.path)"
        [class.border-blue-500]="isActiveRoute(item.path)"
        [class.text-blue-700]="isActiveRoute(item.path)"
        [class.font-semibold]="isActiveRoute(item.path)">
        
        <svg 
          class="w-5 h-5 mr-3 transition-colors duration-200 flex-shrink-0"
          [ngClass]="isActiveRoute(item.path) ? 'text-blue-600' : item.color"
          fill="none" 
          stroke="currentColor" 
          viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" [attr.d]="item.icon"></path>
        </svg>
        
        <span class="text-sm font-medium">{{ item.label }}</span>
        
        <!-- Active indicator -->
        <div 
          *ngIf="isActiveRoute(item.path)" 
          class="ml-auto w-2 h-2 bg-blue-500 rounded-full flex-shrink-0">
        </div>
        
        <!-- Super Admin badge for restricted items -->
        <div 
          *ngIf="item.allowedRoles.includes('super_admin') && !item.allowedRoles.includes('admin')" 
          class="ml-auto flex-shrink-0">
          <span class="text-xs bg-yellow-100 text-yellow-800 px-2 py-1 rounded-full font-semibold">SA</span>
        </div>
      </a>
    </div>
  </nav>

  <!-- Footer info (Fixed at bottom of sidebar) -->
  <div class="p-4 border-t border-gray-200 bg-gray-50 flex-shrink-0">
    <div class="text-xs text-gray-500 text-center">
      <p class="font-medium">Citizen Connect</p>
      <p>Empowering Communities</p>
    </div>
  </div>
</aside>

<!-- Mobile Hamburger Button (Always visible on mobile) -->
<button 
  *ngIf="isMobile"
  (click)="toggleSidebar()" 
  class="fixed top-20 left-4 z-[60] p-3 bg-green-600 text-white rounded-lg shadow-lg hover:bg-green-700 transition-all duration-200 md:hidden"
  [class.z-[60]]="!sidebarOpen"
  [class.z-[45]]="sidebarOpen">
  <svg *ngIf="!sidebarOpen" class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
  </svg>
  <svg *ngIf="sidebarOpen" class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
  </svg>
</button>

